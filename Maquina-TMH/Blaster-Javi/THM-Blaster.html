<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Explotaci贸n de Blaster en THM</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container my-5">
        <h1 class="text-center">Gu铆a Paso a Paso: Explotaci贸n de Blaster</h1>
        <hr>

        <h2>1. Reconocimiento Inicial</h2>
        <p>Realic茅 un escaneo con Nmap para identificar los puertos abiertos.</p>
        <img src="Imagenes/1.png" class="img-fluid" alt="Escaneo de puertos con Nmap">
        <hr>

        <h2>2. Acceso a la p谩gina web</h2>
        <p>Accedimos al servicio HTTP en el puerto 80, que nos lleva a un servidor IIS de Windows.</p>
        <img src="Imagenes/2.png" class="img-fluid" alt="P谩gina IIS">
        <hr>

        <h2>3. Enumeraci贸n de Directorios con Gobuster</h2>
        <p>Utilic茅 Gobuster para escanear directorios en el servidor web.</p>
        <img src="Imagenes/3.png" class="img-fluid" alt="Gobuster scan">
        <hr>

        <h2>4. Acceso a la P谩gina Retro</h2>
        <p>Encontramos una p谩gina con tem谩tica retro en el directorio <code>/retro/</code>.</p>
        <img src="Imagenes/4.png" class="img-fluid" alt="P谩gina retro">
        <img src="Imagenes/5.png" class="img-fluid" alt="P谩gina Ready Player One">
        <hr>

        <h2>5. Identificaci贸n de la Pista</h2>
        <p>En la p谩gina encontramos un comentario clave de Wade sobre su avatar, Parzival.</p>
        <img src="Imagenes/6.png" class="img-fluid" alt="Pista sobre Parzival">
        <hr>

        <h2>6. Acceso a RDP (Escritorio Remoto)</h2>
        <p>Intentamos acceder al puerto 3389 mediante RDP usando las credenciales encontradas.</p>
        <img src="Imagenes/7.png" class="img-fluid" alt="Acceso a RDP">
        <p>Usamos Remmina para acceder con la IP y credenciales:</p>
        <img src="Imagenes/8.png" class="img-fluid" alt="Remmina conexi贸n RDP">
        <hr>

        <h2>7. Obtenci贸n de la bandera de usuario</h2>
        <p>Dentro del escritorio remoto, encontramos la bandera de usuario en <code>user.txt</code>.</p>
        <img src="Imagenes/9.png" class="img-fluid" alt="Explorador de archivos">
        <img src="Imagenes/10.png" class="img-fluid" alt="Archivo user.txt">
        <hr>

        <h2>8. Investigaci贸n de la vulnerabilidad CVE-2019-1388</h2>
        <p>Descubr铆 que el CVE-2019-1388 afecta a servicios ejecutando <code>hhupd</code>.</p>
        <img src="Imagenes/11.png" class="img-fluid" alt="CVE-2019-1388">
        <p>El archivo ejecutable <code>hhupd</code> se encuentra en el escritorio.</p>
        <img src="Imagenes/12.png" class="img-fluid" alt="Ejecutable hhupd">
        <hr>

        <h2>9. Ejecuci贸n de hhupd y explotaci贸n del UAC</h2>
        <p>Al ejecutar <code>hhupd</code>, el sistema pidi贸 privilegios de administrador.</p>
        <img src="Imagenes/13.png" class="img-fluid" alt="Solicitud de UAC">
        <p>Abrimos Internet Explorer con <code>Ctrl + S</code> y navegamos a <code>cmd</code>.</p>
        <img src="Imagenes/15.png" class="img-fluid" alt="Abrir cmd desde IE">
        <img src="Imagenes/16.png" class="img-fluid" alt="Ejecuci贸n de cmd">
        <p>Ahora tenemos una terminal con privilegios de administrador.</p>
        <img src="Imagenes/17.png" class="img-fluid" alt="CMD con privilegios">
        <hr>

        <h2>10. Configuraci贸n del Payload</h2>
        <p>Us茅 Metasploit para generar un payload reverso.</p>
        <img src="Imagenes/19.png" class="img-fluid" alt="Configuraci贸n del payload en Metasploit">
        <img src="Imagenes/20.png" class="img-fluid" alt="Opciones del exploit">
        <hr>

        <h2>11. Ejecuci贸n del Exploit</h2>
        <p>Ejecut茅 el payload y establec铆 la conexi贸n reversa.</p>
        <img src="Imagenes/21.png" class="img-fluid" alt="Ejecuci贸n del exploit">
        <hr>

        <h2>12. Obtener el acceso remoto</h2>
        <p>Tras ejecutar el payload, obtuve acceso con una sesi贸n Meterpreter.</p>
        <img src="Imagenes/22.png" class="img-fluid" alt="Sesi贸n Meterpreter">
        <img src="Imagenes/23.png" class="img-fluid" alt="Sesi贸n establecida">
        <hr>

        <h2>13. Elevaci贸n de privilegios</h2>
        <p>Verifiqu茅 los permisos con <code>whoami</code>, confirmando acceso como <code>NT AUTHORITY\SYSTEM</code>.</p>
        <img src="Imagenes/17.png" class="img-fluid" alt="Privilegios de SYSTEM">
        <hr>

        <h2>14. Obtener la bandera de root</h2>
        <p>Finalmente, acced铆 a <code>root.txt</code> en el escritorio del usuario Administrator.</p>
        <p><strong>Flag obtenida:</strong> <code>THM{COIN_OPERATED_EXPLOITATION}</code></p>
        <img src="Imagenes/18.png" class="img-fluid" alt="Archivo root.txt">
        <hr>

        <h2>Conclusi贸n</h2>
        <p>La explotaci贸n de Blaster requiri贸 m煤ltiples pasos, desde la enumeraci贸n de directorios hasta la explotaci贸n de una vulnerabilidad del UAC. Finalmente, conseguimos acceso completo y obtuvimos la flag de root.</p>
    </div>

    <footer class="bg-dark text-white text-center py-3">
        <p> &copy; 2025 Javi. Todos los derechos reservados.</p>
    </footer>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
